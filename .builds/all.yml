# This Sourcehut job script has been generated by a script via
#
#   haskell-ci 'sourcehut' '--sourcehut-source=https://github.com:fgaz/mysterytube' 'mysterytube.cabal'
#
# To regenerate the script (for example after adjusting tested-with) run
#
#   haskell-ci regenerate
#
# For more information, see https://github.com/haskell-CI/haskell-ci
#
# version: 0.15.20220531
#
# REGENDATA ("0.15.20220531",["sourcehut","--sourcehut-source=https://github.com:fgaz/mysterytube","mysterytube.cabal"])
#
image: ubuntu/bionic
packages:
  - gcc
  - libgmp-dev
  - ghc-7.10.3
  - ghc-8.0.2
  - ghc-8.2.2
  - ghc-8.4.2
  - ghc-8.6.1
  - ghc-8.8.1
repositories:
  hvr-ghc: http://ppa.launchpad.net/hvr/ghc/ubuntu bionic main ff3aeacef6f88286
sources:
  - https://github.com:fgaz/mysterytube
tasks:
  - all-prepare: |
      mkdir -p "$HOME/.ghcup/bin"
      curl -sL https://downloads.haskell.org/ghcup/0.1.17.8/x86_64-linux-ghcup-0.1.17.8 > "$HOME/.ghcup/bin/ghcup"
      chmod a+x "$HOME/.ghcup/bin/ghcup"
      export PATH=$PATH:$HOME/.ghcup/bin
      echo "export PATH=$PATH:$HOME/.ghcup/bin" >> ~/.buildenv
      "$HOME/.ghcup/bin/ghcup" install cabal 3.6
      "$HOME/.ghcup/bin/ghcup" install ghc "ghc-8.10.7"
      "$HOME/.ghcup/bin/ghcup" install ghc "ghc-9.0.2"
      "$HOME/.ghcup/bin/ghcup" install ghc "ghc-9.2.2"
      export PATH=$PATH:/opt/ghc/bin
      echo "export PATH=$PATH:/opt/ghc/bin" >> ~/.buildenv
      cabal update
  - 7_10_3-prepare: |
      cd mysterytube
      cabal configure -w ghc-7.10.3
  - 7_10_3-check: |
      cd mysterytube
      cabal check
  - 7_10_3-dependencies: |
      cd mysterytube
      cabal build all --enable-tests --only-dependencies
      cabal build all --only-dependencies
  - 7_10_3-build: |
      cd mysterytube
      cabal build all
  - 7_10_3-test: |
      cd mysterytube
      cabal test all --enable-tests
  - 8_0_2-prepare: |
      cd mysterytube
      cabal configure -w ghc-8.0.2
  - 8_0_2-check: |
      cd mysterytube
      cabal check
  - 8_0_2-dependencies: |
      cd mysterytube
      cabal build all --enable-tests --only-dependencies
      cabal build all --only-dependencies
  - 8_0_2-build: |
      cd mysterytube
      cabal build all
  - 8_0_2-test: |
      cd mysterytube
      cabal test all --enable-tests
  - 8_2_2-prepare: |
      cd mysterytube
      cabal configure -w ghc-8.2.2
  - 8_2_2-check: |
      cd mysterytube
      cabal check
  - 8_2_2-dependencies: |
      cd mysterytube
      cabal build all --enable-tests --only-dependencies
      cabal build all --only-dependencies
  - 8_2_2-build: |
      cd mysterytube
      cabal build all
  - 8_2_2-test: |
      cd mysterytube
      cabal test all --enable-tests
  - 8_4_2-prepare: |
      cd mysterytube
      cabal configure -w ghc-8.4.2
  - 8_4_2-check: |
      cd mysterytube
      cabal check
  - 8_4_2-dependencies: |
      cd mysterytube
      cabal build all --enable-tests --only-dependencies
      cabal build all --only-dependencies
  - 8_4_2-build: |
      cd mysterytube
      cabal build all
  - 8_4_2-test: |
      cd mysterytube
      cabal test all --enable-tests
  - 8_6_1-prepare: |
      cd mysterytube
      cabal configure -w ghc-8.6.1
  - 8_6_1-check: |
      cd mysterytube
      cabal check
  - 8_6_1-dependencies: |
      cd mysterytube
      cabal build all --enable-tests --only-dependencies
      cabal build all --only-dependencies
  - 8_6_1-build: |
      cd mysterytube
      cabal build all
  - 8_6_1-test: |
      cd mysterytube
      cabal test all --enable-tests
  - 8_8_1-prepare: |
      cd mysterytube
      cabal configure -w ghc-8.8.1
  - 8_8_1-check: |
      cd mysterytube
      cabal check
  - 8_8_1-dependencies: |
      cd mysterytube
      cabal build all --enable-tests --only-dependencies
      cabal build all --only-dependencies
  - 8_8_1-build: |
      cd mysterytube
      cabal build all
  - 8_8_1-test: |
      cd mysterytube
      cabal test all --enable-tests
  - 8_10_7-prepare: |
      cd mysterytube
      cabal configure -w ghc-8.10.7
  - 8_10_7-check: |
      cd mysterytube
      cabal check
  - 8_10_7-dependencies: |
      cd mysterytube
      cabal build all --enable-tests --only-dependencies
      cabal build all --only-dependencies
  - 8_10_7-build: |
      cd mysterytube
      cabal build all
  - 8_10_7-test: |
      cd mysterytube
      cabal test all --enable-tests
  - 9_0_2-prepare: |
      cd mysterytube
      cabal configure -w ghc-9.0.2
  - 9_0_2-check: |
      cd mysterytube
      cabal check
  - 9_0_2-dependencies: |
      cd mysterytube
      cabal build all --enable-tests --only-dependencies
      cabal build all --only-dependencies
  - 9_0_2-build: |
      cd mysterytube
      cabal build all
  - 9_0_2-test: |
      cd mysterytube
      cabal test all --enable-tests
  - 9_2_2-prepare: |
      cd mysterytube
      cabal configure -w ghc-9.2.2
  - 9_2_2-check: |
      cd mysterytube
      cabal check
  - 9_2_2-dependencies: |
      cd mysterytube
      cabal build all --enable-tests --only-dependencies
      cabal build all --only-dependencies
  - 9_2_2-build: |
      cd mysterytube
      cabal build all
  - 9_2_2-test: |
      cd mysterytube
      cabal test all --enable-tests
triggers:
  - action: email
    condition: failure
    to: francygazz@gmail.com
